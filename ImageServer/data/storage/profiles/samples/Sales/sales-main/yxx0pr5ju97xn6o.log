{"type":"operationStart","subtype":"profile","data":{"_id":"uCgn6LvW85DtU9J0","timestamp":"2024-06-25T14:15:48.197Z","state":"queued","mode":"standard","creationDate":"2024-06-25T14:15:48.200Z","modificationDate":"2024-06-25T14:15:48.200Z","shortid":"wjzpVIK","$entitySet":"profiles"},"doDiffs":false,"timestamp":1719324948198,"id":"9ecz8m9rnuy1gzd","previousOperationId":null,"operationId":"oe9fjnify4lyznd"}
{"type":"log","level":"info","message":"Render request 1 queued for execution and waiting for available worker","previousOperationId":"oe9fjnify4lyznd","timestamp":1719324948198,"id":"godkm8ujl6d078g"}
{"type":"operationStart","subtype":"render","name":"sales-main","previousOperationId":"oe9fjnify4lyznd","timestamp":1719324948216,"id":"ypxg6keyzjjmicg","previousEventId":"9ecz8m9rnuy1gzd","operationId":"3o6ujscldtljhv5"}
{"type":"log","timestamp":1719324948216,"level":"info","message":"Starting rendering request 1","meta":{"rootId":"yxx0pr5ju97xn6o","id":"yxx0pr5ju97xn6o"},"id":"2d7hl7t3p3l0o4v","previousOperationId":"3o6ujscldtljhv5"}
{"type":"log","timestamp":1719324948217,"level":"info","message":"Rendering template { name: sales-main, recipe: html-to-xlsx, engine: handlebars, preview: true }","meta":{"rootId":"yxx0pr5ju97xn6o","id":"yxx0pr5ju97xn6o"},"id":"3xf7qt67e8d7lau","previousOperationId":"3o6ujscldtljhv5"}
{"type":"log","timestamp":1719324948218,"level":"debug","message":"Adding sample data B1lSTrt6NB","meta":{"rootId":"yxx0pr5ju97xn6o","id":"yxx0pr5ju97xn6o"},"id":"gox9fv7oexpe6o5","previousOperationId":"3o6ujscldtljhv5"}
{"type":"log","timestamp":1719324948220,"level":"debug","message":"Base url not specified, skipping its injection.","meta":{"rootId":"yxx0pr5ju97xn6o","id":"yxx0pr5ju97xn6o"},"id":"cixlnphxh7brl9b","previousOperationId":"3o6ujscldtljhv5"}
{"type":"operationStart","subtype":"engine","name":"handlebars","timestamp":1719324948220,"id":"b6yny7u3lv5equf","previousEventId":"ypxg6keyzjjmicg","operationId":"c9ubej33ukhh05b","previousOperationId":"3o6ujscldtljhv5"}
{"type":"log","timestamp":1719324948220,"level":"debug","message":"Rendering engine handlebars","meta":{"rootId":"yxx0pr5ju97xn6o","id":"yxx0pr5ju97xn6o"},"id":"yeiggyraoqydo57","previousOperationId":"c9ubej33ukhh05b"}
{"type":"log","timestamp":1719324948514,"level":"warn","message":"Error when processing render request 1\n(because) error when evaluating engine handlebars for template /samples/Sales/sales-main\n(because) require of \"moment\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"moment\"] }\n\n(sandbox.js line 1:165)\n\n> 1 | const moment = require('moment')\n    |                                 ^\n  2 | const rowOffset = 6\n  3 |\n  4 | function nowStr () {\n\n\nError: require of \"moment\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"moment\"] }\n  at sandboxRequire (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/requireSandbox.js:64:19)\n  at Object.require (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:89:30)\n  at eval (sandbox.js:1:165)\n  at async run (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:132:18)\n  at async WorkerReporter.runInSandbox [as _runInSandbox] (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/runInSandbox.js:214:14)\n  at async executeEngine (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:342:16)\n  at async engine.engine (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:146:14)\n  at async invokeRender (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:61:23)\n  at async WorkerReporter._render (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:148:7)\n  at async /Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/reporter.js:232:24\n  at async processAndResponse (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/advanced-workers/lib/workerHandler.js:41:17)\nwrapped by:\nError: Error when evaluating engine handlebars for template /samples/Sales/sales-main\n(because) require of \"moment\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"moment\"] }\n  at module.exports (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at executeEngine (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:365:35)\n  at async engine.engine (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:146:14)\n  at async invokeRender (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:61:23)\n  at async WorkerReporter._render (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:148:7)\n  at async /Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/reporter.js:232:24\n  at async processAndResponse (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/advanced-workers/lib/workerHandler.js:41:17)","meta":{"rootId":"yxx0pr5ju97xn6o","id":"yxx0pr5ju97xn6o"},"id":"kvwu353rmqb6397","previousOperationId":"c9ubej33ukhh05b"}
{"type":"log","timestamp":1719324948515,"level":"warn","message":"Rendering request 1 finished with error in 319 ms","meta":{"rootId":"yxx0pr5ju97xn6o","id":"yxx0pr5ju97xn6o"},"id":"nv9xqtvjjqvdx0s","previousOperationId":"c9ubej33ukhh05b"}
{"type":"error","timestamp":1719324948516,"entity":{"shortid":"B1Q2SFTNr","name":"sales-main","content":"<!--\nExample for html-to-xlsx conversion\nNote: This example requires jsreport to be configured with\n{ \"trustUserCode\": true } or\n{ \"sandbox\": { \"allowedModules\": [\"moment\"] } }\n!-->\n<html>\n    <head>\n        <style>\n            {{asset \"sales-styles.css\" \"utf8\"}}\n        </style>\n    </head>\n    <body>\n        <table name=\"Sales-Detail\">\n            <tbody class=\"head\">\n                <tr>\n                    <td></td>\n                    <td colspan=\"5\" class=\"title\">SALES DETAIL</td>\n                    <td></td>\n                </tr>\n                <tr>\n                    {{generateEmptyCell 7}}\n                </tr>\n                <tr>\n                    {{generateEmptyCell 1}}\n                    <td class=\"label content border-top border-left\">Customer</td>\n                    <td class=\"content border-top\">{{customer}}</td>\n                    {{generateEmptyCell 1 \"content border-top\"}}\n                    <td class=\"label content border-top\">Report Date</td>\n                    <td class=\"content border-top border-right t-right\" data-cell-type=\"date\" data-cell-format-str=\"dd-mm-yyyy\">{{nowStr}}</td>\n                    {{generateEmptyCell 1}}\n                </tr>\n                <tr>\n                    {{generateEmptyCell 1}}\n                    <td class=\"label content border-bottom border-left\">Month</td>\n                    <td class=\"content border-bottom\">{{month}}</td>\n                    {{generateEmptyCell 1 \"content border-bottom\"}}\n                    <td class=\"label content border-bottom\">Tax</td>\n                    <!-- enum = \"9\" percentage -->\n                    <td class=\"content border-bottom border-right t-right\" data-cell-type=\"number\" data-cell-format-enum=\"9\">{{taxPercentage}}</td>\n                    {{generateEmptyCell 1}}\n                </tr>\n                <tr>\n                    {{generateEmptyCell 7}}\n                </tr>\n            </tbody>\n            <tbody class=\"detail\">\n                <tr>\n                    <th class=\"t-center\">Date</th>\n                    <th class=\"t-left\">Product</th>\n                    <th class=\"t-left\">Category</th>\n                    <th class=\"t-right\">Unit Price</th>\n                    <th class=\"t-right\">Quantity</th>\n                    <th class=\"t-right\">Discount</th>\n                    <th class=\"t-right\">Amount</th>\n                </tr>\n                {{#each detail}}\n                    <tr class=\"{{oddClassName @index}}\">\n                        <td class=\"t-center\" data-cell-type=\"date\" data-cell-format-str=\"dd-mm-yyyy\">{{date}}</td>\n                        <td>{{product}}</td>\n                        <td>{{category}}</td>\n                        <td class=\"t-right\" data-cell-type=\"number\">{{unitPrice}}</td>\n                        <td class=\"t-right\" data-cell-type=\"number\">{{quantity}}</td>\n                        <td class=\"t-right\" data-cell-type=\"number\" data-cell-format-enum=\"9\">{{discountPercentage}}</td>\n                        <td class=\"t-right\" data-cell-type=\"formula\">=(D{{getDetailRowIndex @index}}*E{{getDetailRowIndex @index}}) - (D{{getDetailRowIndex @index}}*E{{getDetailRowIndex @index}}*F{{getDetailRowIndex @index}})</td>\n                    </tr>\n                {{/each}}\n                <tr>\n                    {{generateEmptyCell 5}}\n                    <td class=\"label\">Total Net Amount $</td>\n                    <td class=\"t-right\" data-cell-type=\"formula\">=SUM(G{{getDetailRowIndex 0}}:G{{getDetailRowIndex (sum detail.length -1)}})</td>\n                </tr>\n                <tr>\n                    {{generateEmptyCell 5}}\n                    <td class=\"label\" data-cell-type=\"formula\" data-cell-format-enum=\"2\">=CONCATENATE(\"VAT (\", F4*100, \"%)\", \" $\")</td>\n                    <td class=\"t-right\" data-cell-type=\"formula\" data-cell-format-enum=\"2\">=G{{getDetailRowIndex detail.length}}*F4</td>\n                </tr>\n                <tr>\n                    {{generateEmptyCell 5}}\n                    <td class=\"label\">Total $</td>\n                    <td class=\"t-right\" data-cell-type=\"formula\" data-cell-format-enum=\"2\">=SUM(G{{getDetailRowIndex detail.length}}:GG{{getDetailRowIndex (sum detail.length 1)}})</td>\n                </tr>\n            </tbody>\n        </table>\n    </body>\n</html>\n"},"property":"helpers","statusCode":400,"weak":true,"logged":true,"previousOperationId":"c9ubej33ukhh05b","id":"izkrda1t8g3pq8p","stack":"Error: require of \"moment\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"moment\"] }\n  at sandboxRequire (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/requireSandbox.js:64:19)\n  at Object.require (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:89:30)\n  at eval (sandbox.js:1:165)\n  at async run (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/createSandbox.js:132:18)\n  at async WorkerReporter.runInSandbox [as _runInSandbox] (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/sandbox/runInSandbox.js:214:14)\n  at async executeEngine (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:342:16)\n  at async engine.engine (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:146:14)\n  at async invokeRender (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:61:23)\n  at async WorkerReporter._render (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:148:7)\n  at async /Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/reporter.js:232:24\n  at async processAndResponse (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/advanced-workers/lib/workerHandler.js:41:17)\nwrapped by:\nError: Error when evaluating engine handlebars for template /samples/Sales/sales-main\n(because) require of \"moment\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"moment\"] }\n  at module.exports (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/shared/createError.js:10:13)\n  at WorkerReporter.createError (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/shared/reporter.js:53:12)\n  at executeEngine (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:365:35)\n  at async engine.engine (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/render/executeEngine.js:146:14)\n  at async invokeRender (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:61:23)\n  at async WorkerReporter._render (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/render/render.js:148:7)\n  at async /Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/jsreport-core/lib/worker/reporter.js:232:24\n  at async processAndResponse (/Users/eliezerrangel/jsreport-demo/node_modules/@jsreport/advanced-workers/lib/workerHandler.js:41:17)","message":"Error when evaluating engine handlebars for template /samples/Sales/sales-main\n(because) require of \"moment\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"moment\"] }\n\n(sandbox.js line 1:165)\n\n> 1 | const moment = require('moment')\n    |                                 ^\n  2 | const rowOffset = 6\n  3 |\n  4 | function nowStr () {\n\n"}
